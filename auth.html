<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="theme-color" content="#232526">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; connect-src 'self' https://*.supabase.co wss://*.supabase.co; style-src 'self' 'unsafe-inline'; font-src 'self' data:; img-src 'self' data: https:">
  <title>Complete Setup</title>
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body class="public-bg">
  <!-- Loading state -->
  <div id="loading-view" class="login-page">
    <div class="login-page-content user-login-card">
      <div class="loading-spinner" style="margin: 2rem auto;"></div>
      <p style="text-align: center; color: var(--text-muted);">Loading...</p>
    </div>
  </div>

  <!-- Set password view (for invite/recovery) -->
  <div id="set-password-view" class="login-page" style="display: none;">
    <div class="login-page-content user-login-card">
      <h2 id="form-title">Set Your Password</h2>
      <p id="form-subtitle" class="login-subtitle">Create a secure password for your account.</p>
      <form id="set-password-form" class="login-form login-form-centered">
        <div class="form-group">
          <label for="new-password">New Password</label>
          <input type="password" id="new-password" placeholder="Enter password" required minlength="8" autocomplete="new-password">
          <small style="color: var(--text-muted); display: block; margin-top: 0.25rem;">Minimum 8 characters</small>
        </div>
        <div class="form-group">
          <label for="confirm-password">Confirm Password</label>
          <input type="password" id="confirm-password" placeholder="Confirm password" required minlength="8" autocomplete="new-password">
        </div>
        <button type="submit" id="submit-btn">Set Password</button>
      </form>
      <div id="status-message" class="login-status"></div>
    </div>
  </div>

  <!-- Error view -->
  <div id="error-view" class="login-page" style="display: none;">
    <div class="login-page-content user-login-card">
      <h2 style="color: var(--danger);">⚠️ Invalid Link</h2>
      <p id="error-message" style="text-align: center; color: var(--text-muted); margin: 1.5rem 0;"></p>
      <a href="index.html" style="display: inline-block; padding: 0.75rem 1.5rem; background: var(--primary); color: #232526; text-decoration: none; border-radius: var(--radius-sm); font-weight: 600;">Go to Login</a>
    </div>
  </div>

  <!-- Supabase Client Library -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- App Scripts -->
  <script src="assets/js/config.js"></script>
  <script src="assets/js/supabase-config.js"></script>
  <script src="assets/js/utils.js"></script>
  <script src="assets/js/storage.js"></script>
  <script src="assets/js/auth-handler.js"></script>
</body>
</html>
